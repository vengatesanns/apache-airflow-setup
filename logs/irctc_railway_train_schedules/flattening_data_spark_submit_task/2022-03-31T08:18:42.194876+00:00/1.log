[2022-03-31 01:18:54,717] {taskinstance.py:1037} INFO - Dependencies all met for <TaskInstance: irctc_railway_train_schedules.flattening_data_spark_submit_task manual__2022-03-31T08:18:42.194876+00:00 [queued]>
[2022-03-31 01:18:54,731] {taskinstance.py:1037} INFO - Dependencies all met for <TaskInstance: irctc_railway_train_schedules.flattening_data_spark_submit_task manual__2022-03-31T08:18:42.194876+00:00 [queued]>
[2022-03-31 01:18:54,731] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2022-03-31 01:18:54,731] {taskinstance.py:1244} INFO - Starting attempt 1 of 1
[2022-03-31 01:18:54,731] {taskinstance.py:1245} INFO - 
--------------------------------------------------------------------------------
[2022-03-31 01:18:54,753] {taskinstance.py:1264} INFO - Executing <Task(SparkSubmitOperator): flattening_data_spark_submit_task> on 2022-03-31 08:18:42.194876+00:00
[2022-03-31 01:18:54,760] {standard_task_runner.py:52} INFO - Started process 25779 to run task
[2022-03-31 01:18:54,816] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'irctc_railway_train_schedules', 'flattening_data_spark_submit_task', 'manual__2022-03-31T08:18:42.194876+00:00', '--job-id', '17', '--raw', '--subdir', 'DAGS_FOLDER/irctc_railway_train_schedules.py', '--cfg-path', '/tmp/tmp4k3f8xpb', '--error-file', '/tmp/tmpplct5tto']
[2022-03-31 01:18:54,821] {standard_task_runner.py:77} INFO - Job 17: Subtask flattening_data_spark_submit_task
[2022-03-31 01:18:54,960] {logging_mixin.py:109} INFO - Running <TaskInstance: irctc_railway_train_schedules.flattening_data_spark_submit_task manual__2022-03-31T08:18:42.194876+00:00 [running]> on host ubuntu
[2022-03-31 01:18:55,130] {taskinstance.py:1429} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=irctc_railway_train_schedules
AIRFLOW_CTX_TASK_ID=flattening_data_spark_submit_task
AIRFLOW_CTX_EXECUTION_DATE=2022-03-31T08:18:42.194876+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-03-31T08:18:42.194876+00:00
[2022-03-31 01:18:55,153] {base.py:70} INFO - Using connection to: id: spark_submit_connection. Host: spark://ubuntu, Port: 7077, Schema: , Login: , Password: None, extra: {}
[2022-03-31 01:18:55,156] {spark_submit.py:335} INFO - Spark-Submit cmd: spark-submit --master spark://ubuntu:7077 --name arrow-spark --class com.hackprotech.railways.RailwaysDataFlatteningUsingDF /home/vengat/big_data/projects/spark_jars/spark-realtime-projects-assembly-2.0.0.jar
[2022-03-31 01:19:04,140] {spark_submit.py:488} INFO - 22/03/31 01:19:04 WARN Utils: Your hostname, ubuntu resolves to a loopback address: 127.0.1.1; using 192.168.232.128 instead (on interface ens33)
[2022-03-31 01:19:04,145] {spark_submit.py:488} INFO - 22/03/31 01:19:04 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
[2022-03-31 01:19:06,504] {spark_submit.py:488} INFO - Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
[2022-03-31 01:20:57,611] {spark_submit.py:488} INFO - +--------+---+---------+------+------------+-------------------+-------------------------------------+------------+
[2022-03-31 01:20:57,611] {spark_submit.py:488} INFO - |arrival |day|departure|id    |station_code|station_name       |train_name                           |train_number|
[2022-03-31 01:20:57,611] {spark_submit.py:488} INFO - +--------+---+---------+------+------------+-------------------+-------------------------------------+------------+
[2022-03-31 01:20:57,611] {spark_submit.py:488} INFO - |None    |1  |07:55:00 |302214|FM          |KACHEGUDA FALAKNUMA|Falaknuma Lingampalli MMTS           |47154       |
[2022-03-31 01:20:57,612] {spark_submit.py:488} INFO - |None    |1  |18:55:00 |281458|TCR         |THRISUR            |Thrissur Guruvayur Passenger         |56044       |
[2022-03-31 01:20:57,612] {spark_submit.py:488} INFO - |None    |1  |15:05:00 |309335|PBR         |PORBANDAR          |Porbandar Muzaffarpur Express        |19269       |
[2022-03-31 01:20:57,612] {spark_submit.py:488} INFO - |None    |1  |13:30:00 |283774|R           |RAIPUR JN          |RAIPUR ITWARI PASS                   |58205       |
[2022-03-31 01:20:57,612] {spark_submit.py:488} INFO - |None    |1  |07:20:00 |319937|GMO         |GOMOH JN           |Gomoh-Asansol MEMU                   |63542       |
[2022-03-31 01:20:57,612] {spark_submit.py:488} INFO - |None    |1  |16:15:00 |520605|RBL         |RAE BARELI JN      |Rai Bareli-Mumbai LTT Saket Express  |21068       |
[2022-03-31 01:20:57,612] {spark_submit.py:488} INFO - |None    |1  |13:25:00 |335930|SBHR        |Subrahmanya Road   |Subramanya Road Mangalore Passenger  |56646       |
[2022-03-31 01:20:57,612] {spark_submit.py:488} INFO - |None    |1  |07:30:00 |282535|ERS         |ERNAKULAM JN       |Ernakulam Alappuzha Passenger        |56379       |
[2022-03-31 01:20:57,612] {spark_submit.py:488} INFO - |None    |1  |18:40:00 |336174|SRU         |SALEMPUR JN        |Salempur Barhaj Passenger            |55145       |
[2022-03-31 01:20:57,612] {spark_submit.py:488} INFO - |None    |1  |15:15:00 |17022 |BIR         |Bir                |Bir Khandwa Shuttle                  |51688       |
[2022-03-31 01:20:57,613] {spark_submit.py:488} INFO - |None    |1  |17:50:00 |336193|ASN         |ASANSOL JN         |Asansol-Bokaro Steel City MEMU       |63596       |
[2022-03-31 01:20:57,613] {spark_submit.py:488} INFO - |None    |1  |18:40:00 |282465|TPU         |Tanakpur           |Tanakpur Aishbagh Express            |52228       |
[2022-03-31 01:20:57,614] {spark_submit.py:488} INFO - |None    |1  |21:10:00 |336178|BTD         |BOTAD JN           |Botad Bhavnagar Passenger            |59227       |
[2022-03-31 01:20:57,614] {spark_submit.py:488} INFO - |None    |1  |07:25:00 |168737|MFP         |MUZAFFARPUR JN     |Harihar Express                      |14523       |
[2022-03-31 01:20:57,614] {spark_submit.py:488} INFO - |None    |1  |07:10:00 |336277|BRMP        |Biramitrapur       |Birmitrapur Barsuan Passenger        |58151       |
[2022-03-31 01:20:57,614] {spark_submit.py:488} INFO - |None    |1  |17:05:00 |299325|PTN         |PATAN              |Patan Mehsana Passenger              |59478       |
[2022-03-31 01:20:57,614] {spark_submit.py:488} INFO - |None    |1  |20:32:00 |336057|SDAH        |KOLKATA SEALDAH    |Sealdah-Gede Local                   |31929       |
[2022-03-31 01:20:57,614] {spark_submit.py:488} INFO - |06:49:00|1  |06:50:00 |11813 |PPR         |PIPAR ROAD JN      |Pipar Road -Jodhpur Passenger Special|04857       |
[2022-03-31 01:20:57,615] {spark_submit.py:488} INFO - |None    |1  |09:15:00 |318164|BXR         |BUXAR              |Buxar Mughal Sarai Passenger         |53215       |
[2022-03-31 01:20:57,615] {spark_submit.py:488} INFO - |None    |1  |17:50:00 |299882|HWH         |HOWRAH JN          |Howrah Panskura EMU                  |38453       |
[2022-03-31 01:20:57,615] {spark_submit.py:488} INFO - +--------+---+---------+------+------------+-------------------+-------------------------------------+------------+
[2022-03-31 01:20:57,615] {spark_submit.py:488} INFO - only showing top 20 rows
[2022-03-31 01:20:57,615] {spark_submit.py:488} INFO - 
[2022-03-31 01:20:59,780] {spark_submit.py:488} INFO - Exception in thread "main" java.lang.NoSuchMethodError: scala.runtime.ScalaRunTime$.wrapRefArray([Ljava/lang/Object;)Lscala/collection/immutable/ArraySeq;
[2022-03-31 01:20:59,780] {spark_submit.py:488} INFO - at com.hackprotech.railways.RailwaysDataFlatteningUsingDF$.main(RailwaysDataFlatteningUsingDF.scala:37)
[2022-03-31 01:20:59,780] {spark_submit.py:488} INFO - at com.hackprotech.railways.RailwaysDataFlatteningUsingDF.main(RailwaysDataFlatteningUsingDF.scala)
[2022-03-31 01:20:59,780] {spark_submit.py:488} INFO - at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[2022-03-31 01:20:59,780] {spark_submit.py:488} INFO - at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
[2022-03-31 01:20:59,780] {spark_submit.py:488} INFO - at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[2022-03-31 01:20:59,782] {spark_submit.py:488} INFO - at java.lang.reflect.Method.invoke(Method.java:498)
[2022-03-31 01:20:59,782] {spark_submit.py:488} INFO - at org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)
[2022-03-31 01:20:59,782] {spark_submit.py:488} INFO - at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:955)
[2022-03-31 01:20:59,783] {spark_submit.py:488} INFO - at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
[2022-03-31 01:20:59,783] {spark_submit.py:488} INFO - at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
[2022-03-31 01:20:59,783] {spark_submit.py:488} INFO - at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
[2022-03-31 01:20:59,783] {spark_submit.py:488} INFO - at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1043)
[2022-03-31 01:20:59,783] {spark_submit.py:488} INFO - at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1052)
[2022-03-31 01:20:59,783] {spark_submit.py:488} INFO - at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
[2022-03-31 01:21:00,718] {taskinstance.py:1718} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 1334, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 1460, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 1516, in _execute_task
    result = execute_callable(context=context)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/providers/apache/spark/operators/spark_submit.py", line 157, in execute
    self._hook.submit(self._application)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/providers/apache/spark/hooks/spark_submit.py", line 419, in submit
    raise AirflowException(
airflow.exceptions.AirflowException: Cannot execute: spark-submit --master spark://ubuntu:7077 --name arrow-spark --class com.hackprotech.railways.RailwaysDataFlatteningUsingDF /home/vengat/big_data/projects/spark_jars/spark-realtime-projects-assembly-2.0.0.jar. Error code is: 1.
[2022-03-31 01:21:00,731] {taskinstance.py:1272} INFO - Marking task as FAILED. dag_id=irctc_railway_train_schedules, task_id=flattening_data_spark_submit_task, execution_date=20220331T081842, start_date=20220331T081854, end_date=20220331T082100
[2022-03-31 01:21:00,786] {standard_task_runner.py:89} ERROR - Failed to execute job 17 for task flattening_data_spark_submit_task
Traceback (most recent call last):
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/cli/commands/task_command.py", line 180, in _run_raw_task
    ti._run_raw_task(
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 1334, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 1460, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 1516, in _execute_task
    result = execute_callable(context=context)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/providers/apache/spark/operators/spark_submit.py", line 157, in execute
    self._hook.submit(self._application)
  File "/home/vengat/big_data/python/venv/aflow_env/lib/python3.9/site-packages/airflow/providers/apache/spark/hooks/spark_submit.py", line 419, in submit
    raise AirflowException(
airflow.exceptions.AirflowException: Cannot execute: spark-submit --master spark://ubuntu:7077 --name arrow-spark --class com.hackprotech.railways.RailwaysDataFlatteningUsingDF /home/vengat/big_data/projects/spark_jars/spark-realtime-projects-assembly-2.0.0.jar. Error code is: 1.
[2022-03-31 01:21:00,822] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-03-31 01:21:00,853] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
